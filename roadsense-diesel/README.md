# RoadSense - Diesel ORM Migrations

This repository contains the database migrations and schema definitions for the \textbf{RoadSense} system, intended to be shared by both the API and consumer services (written in Rust). Centralizing the migrations here ensures consistency and avoids duplicating schema definitions across different components of the system.

## Features

- Centralized database migrations for the Diesel ORM model.
- Simplifies schema updates for both the API and the consumer services.
- Maintains consistency between database structure and application logic.

## Requirements

Ensure you have the following tools installed:

- [Diesel CLI](https://diesel.rs/guides/getting-started/) for managing migrations.
- A PostgreSQL database instance to apply migrations.

## Getting Started

### Running Migrations

To apply the migrations to your database, use the Diesel CLI:

```sh
diesel migration run
```

### Creating a New Migration

To create a new migration, use the following command:

```sh
diesel migration generate <migration_name>
```

This will create a new folder inside the migrations/ directory with separate files for up (to apply the migration) and down (to undo the migration) scripts.

### Redoing the Last Migration

To undo and reapply the last migration, run:

```
diesel migration redo
```

### Reverting Migrations

To revert all applied migrations, use:

```sh
diesel migration revert
```

## Directory Structure

- **`migrations/`**: This directory contains all the Diesel migration files, with each migration stored in its own folder. Each migration includes `up.sql` and `down.sql` scripts for applying and rolling back the changes. Learn more about migrations in the [Diesel Migrations Guide](https://diesel.rs/guides/getting-started/).
- **`schema.rs`**: This file is automatically generated by Diesel and includes the database schema. It can be imported into Rust projects to enable type-safe queries. See the [Diesel Schema Inference](https://diesel.rs/guides/schema-inference/) documentation for details.

## Notes

- Ensure that any schema changes are reflected in both the API and the consumer projects. This avoids discrepancies that could cause runtime errors.
- For advanced features and migration techniques, refer to the [Diesel Documentation](https://diesel.rs/).
